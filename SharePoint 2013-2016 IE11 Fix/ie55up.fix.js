// fix drag'n'drop for IE11
MSOLayout_MoveWebPartStart=function(e,t,n,o){if(null!=window.event&&0==window.event.button){MSOLayout_currentDragMode="move",document.selection&&document.selection.empty(),MSOLayout_galleryView=1==o,MSOLayout_CreateDragObject(n),MSOLayout_CreateIBar(),MSOLayout_oDropLocation=t;var a=t.getAttribute("allowZoneChange");MSOLayout_maintainOriginalZone="0"==a?MSOLayout_GetParentWPZoneDiv(t):"0";var r=t.getAttribute("zoneid");if(MSOLayout_galleryView&&void 0!==t.dzc&&null!=t.dzc){var i=GetElementsByName("MSOZone");if(null!=i&&i.length>1)for(var l=0;l<i.length;l++)if(i[l].zoneID==r){MSOLayout_maintainOriginalZone=i[l];break}}MSOLayout_iBar.setAttribute("goodDrop","false");var d=MSOLayout_GetParentWPZoneDiv(t);if("MSOZone"==d.id&&(MSOLayout_zoneDragOver=d,Sys.UI.DomElement.addCssClass(MSOLayout_zoneDragOver,"ms-SPZoneSelected")),MSOLayout_galleryView||MSOLayout_IsWikiEditMode()||MSOLayout_MoveIBar(t),AddEvtHandler(document.body,"ondragover",MSOLayout_MoveWebPartBodyDragOver),void 0!==document.body.ondragend)var s=document.body.ondragend;if(void 0!==document.body.ondrop)var u=document.body.ondrop;document.body.ondragend=new Function("window.event.returnValue = false;"),MSOLayout_zoneDragOver.ondrop=document.body.ondrop=new Function("MSOLayout_iBar.setAttribute('goodDrop', 'true')"),t.ondragstart=new Function("try {event.dataTransfer.effectAllowed = 'move';} catch (exception) {}"),AddEvtHandler(t,"ondrag",MSOLayout_MoveDragObject),t.dragDrop(),DetachEvent("dragover",MSOLayout_MoveWebPartBodyDragOver,document.body),document.body.ondragend=s,document.body.ondrop=u,DetachEvent("drag",MSOLayout_MoveDragObject,t),MSOLayout_moveObject.style.display="none",MSOLayout_currentDragMode="",event.returnValue=!1}},MSOLayout_MoveWebPart=function(OriginalZoneCell,DestinationZoneCell){if(MSOLayout_iBar.style.display="none",Sys.UI.DomElement.removeCssClass(MSOLayout_zoneDragOver,"ms-SPZoneSelected"),"move"==MSOLayout_currentDragMode&&OriginalZoneCell!=DestinationZoneCell){var newTableCell,originalZone=MSOLayout_GetParentWPZoneDiv(OriginalZoneCell),originalIndex,originalOrientation=OriginalZoneCell.getAttribute("orientation"),destinationZone,destinationIndex;originalIndex=MSOLayout_CalculateZoneCellIndex(OriginalZoneCell),destinationZone=MSOLayout_GetParentWPZoneDiv(DestinationZoneCell);var zonesChanged=destinationZone!=originalZone,destinationOrientation=DestinationZoneCell.getAttribute("orientation");destinationIndex=MSOLayout_CalculateZoneCellIndex(DestinationZoneCell);var zoneCellPlaceHolder=document.createElement("div");if(DestinationZoneCell.parentNode.insertBefore(zoneCellPlaceHolder,DestinationZoneCell),zoneCellPlaceHolder.swapNode(OriginalZoneCell),zoneCellPlaceHolder.removeNode(!0),OriginalZoneCell.setAttribute("orientation",destinationOrientation),zonesChanged){var originalEmptyZoneText=getFirstElementByName(originalZone,"MSOZoneCell_emptyZoneText"),destinationEmptyZoneText=getFirstElementByName(destinationZone,"MSOZoneCell_emptyZoneText");if(null!=originalEmptyZoneText){var strNumWebParts=originalEmptyZoneText.getAttribute("webPartsInZone");if(null!=strNumWebParts){var numWebParts=Number(strNumWebParts);numWebParts--,0==numWebParts&&(originalEmptyZoneText.style.display="",originalEmptyZoneText.parentNode.style.padding=""),originalEmptyZoneText.setAttribute("webPartsInZone",String(numWebParts))}}if(null!=destinationEmptyZoneText){var strDestNumWebParts=destinationEmptyZoneText.getAttribute("webPartsInZone");if(null!=strDestNumWebParts){var numDestWebParts=Number(strDestNumWebParts);numDestWebParts++,destinationEmptyZoneText.setAttribute("webPartsInZone",String(numDestWebParts))}destinationEmptyZoneText.style.display="none",destinationEmptyZoneText.parentNode.style.padding="0"}}if(zonesChanged||destinationIndex!=originalIndex&&destinationIndex!=originalIndex+1){if(originalZone!=destinationZone){var destZoneId=destinationZone.getAttribute("zoneID"),relatedWebPart=OriginalZoneCell.getAttribute("relatedwebpart");null!=relatedWebPart&&null!=destZoneId&&MSOLayout_AddChange(eval(relatedWebPart),"Zone",destZoneId),MSOLayout_UpdatePartOrderAfterMove(originalZone,0)}MSOLayout_UpdatePartOrderAfterMove(destinationZone,0)}zonesChanged&&("Horizontal"==destinationOrientation?MSOLayout_AdjustHorizontalZoneCells(destinationZone):Sys.UI.DomElement.removeCssClass(OriginalZoneCell,"ms-webpart-cell-horizontal"))}};